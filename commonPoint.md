# C++底层常识

ref: <https://shentuzhigang.blog.csdn.net/article/details/90726422>

## 编译器模块

### .c 到.exe 整个编译过程的步骤

ref: <https://blog.csdn.net/xinianbuxiu/article/details/51844994>

整个过程：**C源程序－>编译预处理－>编译－>汇编程序－>链接程序－>可执行文件**

1. 预处理  读取c源程序，对其中的伪指令（以`#`开头的指令）和特殊符号进行处理。伪指令主要包括以下三个方面:

    + 宏定义指定
    + 条件编译指令
    + 头文件

    特点：

    + 预编译是将.c 文件转化成 .i文件，　　
    + 重定向使用的gcc命令是：gcc –E hello.c >hello.i
    + **在预处理阶段是不做语法检查的。**

2. 编译阶段

    需要进行三个步骤：词法分析、语法分析和语义分析

    在linux环境中，输入命令：gcc–s  hello.c  参数c告诉gcc命令只进行编译，不做其他处理。命令运行结束后产生`hello.o`的目标文件。

3. 汇编过程
    编译过程实际上指把汇编语言代码翻译成目标机器指令的过程。对于被翻译系统处理的每一个C语言源程序，都将最终经过这一处理而得到相应的目标文件。目标文件中所存放的也就是与源程序等效的目标的机器语言代码。

4. 链接过程

+ 链接就是将不同部分的代码和数据收集和组合成为一个单一文件的过程,这个文件可被加载或拷贝到存储器执行.
+ 链接可以执行与编译时(源代码被翻译成机器代码时),也可以执行与加载时(在程序被   加载器加载到存储器并执行时),甚至执行与运行时,由应用程序来执行.在现代系统中,    链接是由链接器自动执行的.
+ 链接器分为:静态链接器和动态链接器两种.

## 编程原则

1. 在没有必要刷新输出流的时候应尽量使用cout << ‘\n’, 过多的endl是影响程序执行效率低下的因素之一.
2. `>>` 右移运算符比除法高效，判断奇偶 `n & 1` 比 `n % 2 ==0` 高效。
3. `swap()` 函数效率高于 `a ^= b ^= a ^= b`
4. `++i` 比 `i++` 效率高，尤其在STL中

## 快速幂的应用

斐波那契数列的第n项取模，求出 $F_n \ \rm{mod}\  (10^9 + 7)$.
设矩阵
$$
A=
\begin{bmatrix}
0 & 1 \\
1 & 1
\end{bmatrix}
$$
我们有：
$$
A\begin{bmatrix}
F_n \\
F_{n+1}
\end{bmatrix}=
\begin{bmatrix}
F_{n+1}\\
F_n+F_{n+1}
\end{bmatrix}=
\begin{bmatrix}
F_{n+1}\\
F_{n+2}
\end{bmatrix}
$$
于是：
$$
\begin{aligned}
\begin{bmatrix}
F_{n}\\
F_{n+1}
\end{bmatrix} &= A
\begin{bmatrix}
F_{n-1}\\
F_n
\end{bmatrix}\\
&= A^2
\begin{bmatrix}
F_{n-2}\\
F_{n-1}
\end{bmatrix}\\
&= \cdots \\
&= A^{n-1}
\begin{bmatrix}
F_{1}\\
F_{2}
\end{bmatrix} \\
&=A^{n-1}
\begin{bmatrix}
1\\
1
\end{bmatrix}
\end{aligned} \tag{3}
$$

## 运算符优先级

ref: <https://blog.csdn.net/zz56z56/article/details/82843627>
ref2: <https://m.php.cn/article/478225.html>

完整口诀是：“单算移关与，异或逻条赋”

+ “单”表示单目运算符：逻辑非(!),按位取反(~),自增(++),自减(--),取地址(&),取值(*)；

+ “算”表示算术运算符：乘、除和求余(*,/,%)级别高于加减(+,-)；

+ “移”表示按位左移(<<)和位右移(>>)；

+ “关”表示关系运算符：大小关系(>,>=,<,<=)级别高于相等不相等关系(==,!=)；

+ “与”表示按位与(&)；

+ “异”表示按位异或(^)；

+ “或”表示按位或(|)；

+ “逻”表示逻辑运算符：逻辑与(&&)级别高于逻辑或(||)；

+ “条”表示条件运算符(? :)；

+ “赋”表示赋值运算符(=,+=,-=,*=,/=,%=,>>=,<<=,&=,^=, |=,!=)；

+ 另，逗号运算符(,) 级别最低，口诀中没有表述，需另加记忆.

### 逗号运算符

逗号运算符的一般形式为：`表达式1, 表达式2`

**其求值过程是分别求两个表达式的值，并以表达式2的值作为整个逗号表达式的值。**

```c++
#include <stdio.h>
 
int main()
{
    int a=2,b=4,c=6,x,y;
    y=((x=a+b),(b+c));
    printf("y=%d,x=%d",x,y); 

    return 0;
}    
// output: y = 10, x = 6 
```

### 常用C++库函数 （STL）

1. `sort()` 排序
2. `memset` 赋值
3. `next_permutation` 全排列
4. `max` 最大值
5. `min` 最小值
6. `swap` 交换
7. `exit` 退出程序
8. `__builtin_popcount` 一个数的二进制表示中有多少位是1
9. `strlen` 字符数组长度
